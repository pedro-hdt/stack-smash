pdis 0x40058e
asmsearch "add esp, 0x8; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "push ?; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "push ?; push ?; ret" /lib/x86_64-linux-gnu/libc-2.23.so
ls
q
start
b * 0x400856
continue
start
ni
b* rop
continue
ni
delete breakpoint 2
delete breakpoint 3
delete breakpoint 4
delete breakpoint 5
start
b* rop
continue
ni
stack20
stack 20
start
continue
ni
stack 20
stack 50
ni
vmmap
asmsearch "mov ?, rsp; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov ?, rsp; ret"
pdis main
p strcpy
asmsearch "rsp"
asmsearch "push rsp, ret"
asmsearch "push rsp; ret"
asmsearch "push rsp; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "push rsp; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "push ?; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov ?, rsp; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rax, rsp; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rbx, rsp; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rbp, rsp; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rbp, rsp" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rbp, rsp; ? ; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "mov rbp, rsp; push ? ; ret" /lib/x86_64-linux-gnu/ld-2.23.so
pdis 0x00007ffff7dd85a1
pdis 0x00007ffff7dd89b1
pdis 0x00007ffff7dd89b1
info registers
show registers
registers
infor register
infor registers
info registers
asmsearch "push r13; ret"
asmsearch "push r13; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "push r13; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
pdis main
pdis rop
asmsearch "push r13; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "push r13; push ?; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
asmsearch "push r13" /lib/x86_64-linux-gnu/ld-2.23.so
pdis 0x00007ffff7dd7ec0
pdis 0x00007ffff7dd85a8
info registeers
info registers
asmsearch "push rsp; push ?; ret" /lib/x86_64-linux-gnu/ld-2.23.so
ls
start
continue
ni
asmsearch "mov rdi, r13; ret"
vmmap
asmsearch "mov rdi, r13; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov ?, r13; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov ?, r13;" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, r13;" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, r13; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, r13; push ?; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, r13; pop ?; ret" /lib/x86_64-linux-gnu/libc-2.23.so
ni
q
start
find FILENAME
q
start
find EXPLOIT
find FILENAME
q
start
find FILENAME
q
q
start
b * rop
continue
ni
start
find FILENAME
q
start
find FILENAME
q
start
b * rop
ni
start
b* rop
ni
q
start
b* rop
continue
q
start b* rop
b* rop
q
start
b* rop
continue
ni
q
start
find FILENAME
q
start
b* rop
continue
ni
q
find FILENAME
start
find FILENAME
b* rop
continue
ni
p 0x7ffff7dd1000
p *0x7ffff7dd1000
ni
q
start
find getenv
asmsearch "mov rdi, rax; ret"
vmmap
asmsearch "mov rdi, rax; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, rax" /lib/x86_64-linux-gnu/libc-2.23.so
q
aslr
q
run
start
find FILENAME
q
run
start
b* rop
q
start
find write
p write
q
start
p exit
q
run
start
find FILENAME
p FILENAME
q
run
start
find FILENAME
q
run
vmmap
start
vmmap
q
start
vmmap
start p FILENAME
p FILENAME
find FILENAME
run
start
vmmap
b* rop
ni
continue
start
continue
ni
p &buf
ni
ni
stack 20
ni
start
continue
ni
ni
run
run
run
delete breakpoint 2
run
run
run
stop
exit
q
run
run
run
run
run < -1
vmmap
start
startr
un
run
q
start
vmmap
asmsearch "push rax; ret" /lib/x86_64-linux-gnu/libc-2.23.so
run
asmsearch "push rax; pop rdi; ret" /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch "mov rdi, rax; ret" /lib/x86_64-linux-gnu/libc-2.23.so
run
echo -ne '-1' | run
asmsearch "mov rdi, rax; ret" /lib/x86_64-linux-gnu/libc-2.23.soq
q
pdis rop
start
b* rop
continue
ni
q
start
p fseek
p SEEK_END
find SEEK_END
b* rop
cont
continue
ni
vmmap
asmsearch 'mov rdx, rax; ret'
asmsearch 'mov rdx, rax; ret' /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch 'mov rax; ret' /lib/x86_64-linux-gnu/libc-2.23.so
asmsearch 'mov ?, rax; ret' /lib/x86_64-linux-gnu/libc-2.23.so
ni
q
